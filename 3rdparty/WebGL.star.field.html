<!--

    CC3.0 Distribution License

    NOTE: This software is released under CC3.0 creative commons
    If using in own projects please give credit to the original author,

    By linking to:

    http://www.webgltutorials.org

    Thanks :-)

	view-source:http://www.tigrisgames.com/fx/starfield.php

//-->
<html>
    <head>
        <title>Starfield Demo</title>
    </head>
    <body>
		<h1>Star Field</h1>
		<canvas id = "canvas" width = "501" height = "501"></canvas><br />
		<button id = "button">START/PAUSE</button>
<script>
window.onload = (function (win, doc) {
	var canvas  = document.getElementById ("canvas");
	var context = window.gfx = canvas.getContext ('2d');
	var button  = document.getElementById ("button");
	var ScreenW = canvas.width;
	var ScreenH = canvas.height;
	var ScreenR = (ScreenH/ScreenW);

	var MAX_DEPTH = 10;
	var move = false;

	button.addEventListener ("click", function (event) {
		move = !move;
	});

	class Star {

		constructor () {

			this.reset = function ()
			{
				this.x = 1 - Math.random () * 2.0;
				this.y = 1 - Math.random () * 2.0;
				this.z = Math.random () * -MAX_DEPTH;
				this.x2d = 0;
				this.y2d = 0;
				this.angle = 0.001;
			}

			this.project = function ()
			{
				if (move) {
					// Rotate this star around Z axis using trigonometry (sine & cosine)
					this.x = this.x * Math.cos (this.angle) - this.y * Math.sin (this.angle);
					this.y = this.y * Math.cos (this.angle) + this.x * Math.sin (this.angle);
				}

				// Calculate "Camera View". Project 3D star coordinates to 2D screen
				this.x2d = ScreenW * ScreenR * this.x / this.z + (ScreenW / 2);
				this.y2d = ScreenH           * this.y / this.z + (ScreenH / 2);

				// this.x2d = ScreenW * this.x / this.z + (ScreenW / 2);
				this.y2d = ScreenH * this.y / this.z + (ScreenH / 2);

				if (move) {
					// Move star toward the camera
					this.z += 0.0025;
				}

				// Reset this star if it goes outside of the viewing area
				if (this.x2d <= 0 || this.x2d >= ScreenW ||
					this.y2d <= 0 || this.y2d >= ScreenH)
					this.reset ();
				return this;
			}

			this.draw = function ()
			{
				var star_size = 4 * (4 - (-this.z / 2));
				var star_color = (MAX_DEPTH + this.z) / (MAX_DEPTH*2);

				window.gfx.globalAlpha = star_color;
				window.gfx.fillStyle = 'white';
				window.gfx.fillRect (this.x2d, this.y2d, star_size, star_size);
				window.gfx.globalAlpha = 0.3;
				return this;
			}

			// Reset (initialize) on object construction
			this.reset ();
		}
	}

	// Initialize stars

	var STARS_MAX = 1000;

	var stars = new Array (STARS_MAX);

	for (let i = 0; i < STARS_MAX; i++) stars[i] = new Star ();

	// Main animation loop
	setInterval (function  () {

		// Clear screen
		gfx.beginPath ();
		gfx.fillStyle = 'black';
		gfx.rect (0, 0, ScreenW, ScreenH);
		gfx.fill ();

		// Move and draw stars
		gfx.beginPath ();
		for (star of stars) { star.project ().draw (); }
		gfx.fill ();

	}, 0);
}) (window, document);

        </script>
	</body>
</html>
