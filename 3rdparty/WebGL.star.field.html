<!--

    CC3.0 Distribution License

    NOTE: This software is released under CC3.0 creative commons
    If using in own projects please give credit to the original author,

    By linking to:

    http://www.webgltutorials.org

    Thanks :-)

	view-source:http://www.tigrisgames.com/fx/starfield.php

	Modified by: Jonathan D. Lettvin, 20180818

//-->
<html>
    <head>
        <title>Starfield Demo</title>
    </head>
    <body>
		<table><tr>
			<td><h1>Star Field</h1></td>
			<td><button id = "button">START/PAUSE</button></td>
		</tr></table>
		<canvas id = "canvas" width = "501" height = "501"></canvas><br />
<script>
window.onload = (function (win, doc) {
	var move    = false;
	var canvas  = document.getElementById ("canvas");
	var context = window.gfx = canvas.getContext ('2d');
	var button  = document.getElementById ("button");
	var ScreenW = canvas.width;
	var ScreenH = canvas.height;
	var ScreenR = (ScreenH/ScreenW);

	var MAX_DEPTH = 10;
	var STARS_MAX = 1000;

	button.addEventListener ("click", function (event) { move = !move; });

	class Star {

		constructor () {

			this.reset = function ()
			{
				this.x = 1 - Math.random () * 2.0;
				this.y = 1 - Math.random () * 2.0;
				this.z = Math.random () * -MAX_DEPTH;
				this.x2d = 0;
				this.y2d = 0;
				this.angle = 0.001;
				this.scaleX = 3;
				this.scaleY = 3;
			}

			this.project = function ()
			{
				var angle = this.angle, x = this.x, y = this.y;
				if (move) { // Trigonometry to rotate star around Z axis
					this.x = x = x * Math.cos (angle) - y * Math.sin (angle);
					this.y = y = y * Math.cos (angle) + x * Math.sin (angle);
				}

				// Calculate "Camera View". Project 3D star coordinates to 2D screen
				this.x2d = ScreenW * ScreenR * x / this.z + (ScreenW / 2);
				this.y2d = ScreenH           * y / this.z + (ScreenH / 2);

				this.x2d = ScreenW * x / this.z + (ScreenW / 2);
				this.y2d = ScreenH * y / this.z + (ScreenH / 2);

				if (move) { this.z += 0.0025; } // Move star toward the camera

				// Reset this star if it goes outside of the viewing area
				if (this.x2d <= 0 || this.x2d >= ScreenW ||
					this.y2d <= 0 || this.y2d >= ScreenH)
					this.reset ();
				return this;
			}

			this.draw = function ()
			{
				var star_sizeX = this.scaleX * (4 + (this.z / 2));
				var star_sizeY = this.scaleY * (4 + (this.z / 2));
				var star_color = (MAX_DEPTH + this.z) / (MAX_DEPTH*2);

				window.gfx.globalAlpha = star_color;
				window.gfx.fillStyle = 'white';
				window.gfx.fillRect (this.x2d, this.y2d, star_sizeX, star_sizeY);
				window.gfx.globalAlpha = 0.3;
				return this;
			}

			// Reset (initialize) on object construction
			this.reset ();
		}
	}

	// Initialize stars
	var stars = new Array (STARS_MAX);
	for (let i = 0; i < STARS_MAX; i++) stars[i] = new Star ();

	// Main animation loop
	setInterval (function  () {

		// Clear screen
		gfx.beginPath ();
		gfx.fillStyle = 'gray';
		gfx.rect (0, 0, ScreenW, ScreenH);
		gfx.fill ();

		// Move and draw stars
		gfx.beginPath ();
		for (star of stars) { star.project ().draw (); }
		gfx.fill ();

	}, 0);
}) (window, document);

        </script>
	</body>
</html>
